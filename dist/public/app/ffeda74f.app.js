"use strict";angular.module("topProgrammingBlogsApp",["ngCookies","ngResource","ngSanitize","ui.router","ui.bootstrap","firebase"]).config(["$stateProvider","$urlRouterProvider","$locationProvider",function(a,b,c){b.otherwise("/"),c.html5Mode(!0)}]),angular.module("topProgrammingBlogsApp").factory("TwitterService",["$http","$q",function(a,b){var c=function(c){var d=b.defer();return a.get("/twitter/user/"+c).success(function(a){return d.resolve(a)}).error(function(a){return d.reject(a)}),d.promise};return{getUser:c}}]).factory("MozService",["$http","$q",function(a,b){var c=function(c){var d=b.defer();return a.get("/api/url-metrics/"+c).success(function(a){return d.resolve(a)}).error(function(a){return d.reject(a)}),d.promise};return{getMoz:c}}]).controller("MainCtrl",["$scope","$http","$firebaseObject","$firebaseArray","$resource","TwitterService","MozService",function(a,b,c,d,e,f,g){a.currentTwitterCount=[],a.getTwitterCount=function(b){var c=a.blogs[b].twitterName;f.getUser(c).then(function(c){a.twitterErrors=void 0,a.follower=c,a.currentTwitterCount[b]=c,a.updateTwitter=function(){var c=a.blogs[b];c.twitterFollowers=a.follower,a.blogs.$save(c)},a.updateTwitter()})["catch"](function(a){console.error("there was an error retrieving data: ",a)})},a.updateBlogScore=function(b){var c=a.blogs[b].votes.length,d=a.blogs[b].linkingsites,e=a.blogs[b].mozrank,f=a.blogs[b].pageauthority,g=a.blogs[b].twitterFollowers,h=c+5e-5*d+.05*e+.025*f+5e-5*g,i=a.blogs[b];i.blogScore=h,a.blogs.$save(i)},a.currentImage="/assets/images/e173c4e1.balloons.jpeg",a.randomImage=function(){a.backgroundImage=["/assets/images/2b7451d3.mountain-sunset.jpg","/assets/images/9b7784c6.telephone.jpg","/assets/images/f1f979cd.grand-central.jpg","/assets/images/e173c4e1.balloons.jpeg","/assets/images/d5bf250b.northern-lights.jpg","/assets/images/69a6ccd8.city-river.jpg","/assets/images/8c8e710d.rainy-window.jpg","/assets/images/1beab92e.snow-trees.jpg","/assets/images/d4ddfb4c.coffee.jpg","/assets/images/9d1edd5e.cave-light.jpg","/assets/images/34359942.ocean.jpg","/assets/images/0d8c0849.sea-sunset.jpg","/assets/images/93f76bcd.rock-forest.jpg","/assets/images/2b7451d3.mountain-sunset.jpg"];var b=Math.floor(13*Math.random()+1);a.currentImage=a.backgroundImage[b]};var h=new Firebase("https://top-programming.firebaseio.com/");a.data=c(h),a.blogs=d(h),a.blogs.$loaded().then(function(b){a.currentRss=new Array(b.length),a.currentTwitterCount=new Array(b.length)}),h.authWithOAuthPopup("facebook",function(b,c){b?console.log("Login Failed!",b):(console.log("Authenticated successfully with payload:",c),a.currentUid=c.uid,a.userName=c.facebook.displayName,a.$apply())}),a.showRss=function(b){function c(){var c=new google.feeds.Feed(d);c.load(function(c){if(!c.error){var d=c.feed.entries[0];a.currentRss[b]=d,a.updateRss=function(){var c=a.blogs[b];c.rssTitle=a.currentRss[b].title,c.rssUrl=a.currentRss[b].link,a.blogs.$save(c)},a.updateRss()}a.$apply()})}var d=a.blogs[b].rssFeed;google.load("feeds","1"),c()},a.addBlog=function(){var b=a.newContent,c=a.newMainUrl,d=a.newTwitter,e=a.newTwitUrl,f=a.newRss,g={name:b,url:"www.mozexampleurl.com",pageauthority:0,linkingsites:0,mozrank:0,pagerank:5,votes:[1],twitterName:d,twitterUrl:e,twitterFollowers:100,rssFeed:f,blogScore:100,rssTitle:"Newly Submitted Blog",rssUrl:"http://www.google.com/",mainUrl:c};a.blogs.$add(g),a.blogs.$save(g)},a.addVote=function(b){if(b.votes.indexOf(a.currentUid)<0){var c=b;c.votes.push(a.currentUid),a.blogs.$save(c)}else{var c=b,d=c.votes.indexOf(a.currentUid);c.votes.splice(d,1),a.blogs.$save(c)}},a.sortBy="-blogScore"}]),angular.module("topProgrammingBlogsApp").config(["$stateProvider",function(a){a.state("main",{url:"/",templateUrl:"app/main/main.html",controller:"MainCtrl"}),a.state("about",{url:"/about",templateUrl:"app/about.html",controller:"MainCtrl"}),a.state("instructions",{url:"/instructions",templateUrl:"app/instructions.html",controller:"MainCtrl"})}]),angular.module("topProgrammingBlogsApp").factory("Modal",["$rootScope","$modal",function(a,b){function c(c,d){var e=a.$new();return c=c||{},d=d||"modal-default",angular.extend(e,c),b.open({templateUrl:"components/modal/modal.html",windowClass:d,scope:e})}return{confirm:{"delete":function(a){return a=a||angular.noop,function(){var b,d=Array.prototype.slice.call(arguments),e=d.shift();b=c({modal:{dismissable:!0,title:"Confirm Delete",html:"<p>Are you sure you want to delete <strong>"+e+"</strong> ?</p>",buttons:[{classes:"btn-danger",text:"Delete",click:function(a){b.close(a)}},{classes:"btn-default",text:"Cancel",click:function(a){b.dismiss(a)}}]}},"modal-danger"),b.result.then(function(b){a.apply(b,d)})}}}}}]),angular.module("topProgrammingBlogsApp").controller("NavbarCtrl",["$scope","$location",function(a,b){a.menu=[{title:"Home",link:"/"}],a.isCollapsed=!0,a.isActive=function(a){return a===b.path()}}]),angular.module("topProgrammingBlogsApp").run(["$templateCache",function(a){a.put("app/about.html",'<div ng-include="\'components/navbar/navbar.html\'"></div><div class=container><div class=row><div class=col-lg-12><p>Hello {{ userName }}.</p><h1>Top Programming Blogs</h1><p>Top Programming Blogs ranks the top blogs in the programming field based on votes by the community and website metrics. Features of the application include:</p><h3><span class="glyphicon glyphicon-ok"></span> The Top Blogs Ranked by Votes and Website Metrics</h3><p>The blogs are ranked according to the number of votes, MozRank, Page Authority, external links to the URL, and Twitter followers.</p><h3><span class="glyphicon glyphicon-ok"></span> View Your Favorite Blogs</h3><p>You can view only the blogs you upvoted by clicking on the button "View My Favorite Blogs" as long as you are logged into Facebook.</p><h3><span class="glyphicon glyphicon-ok"></span> View the Latest Article from Each Blog</h3><p>The latest article from each blog is displayed allowing you to quickly scan the top blogs for article titles of interest.</p><p>Top Programming Blogs is the capstone project of Charles Sipe for the Bloc Front-End Development Online Bootcamp. You can read more about his bootcamp experience at <a href="http://www.charlessipe.com/bloc-review/">http://www.charlessipe.com/bloc-review/</a>.</p><p>Please send feedback to Charles Sipe at csipe84(at)gmail.com.</p><footer class=footer><p>Angular Fullstack v2.0.13 | <a href=https://twitter.com/tyhenkel>@tyhenkel</a> | <a href="https://github.com/DaftMonk/generator-angular-fullstack/issues?state=open">Issues</a></p></footer></div></div></div>'),a.put("app/instructions.html",'<div ng-include="\'components/navbar/navbar.html\'"></div><div class=container><div class=row><div class=col-lg-12><p>Hello {{ userName }}.</p><h1>Instructions</h1><p>Top Programming Blogs ranks the top blogs in the programming field based on votes by the community and website metrics.</p><h3>Log In With Facebook</h3><p>Log in with your Facebook account when prompted by the pop-up to take advantage of all the features of the app, including voting and viewing your favorite blogs.</p><h3>Click on the Thumbs Up Icon to Vote for a Blog or Remove Your Vote</h3><p>One click adds your vote and clicking again removes your vote. Blogs you have voted for will appear on your "Favorite Blogs."</p><img src=assets/images/262bd535.upvote.png width=60><h3>Click on "View Favorite Blogs" to Display Your Favorite Blogs</h3><p>To switch back to view all blogs, click on "View All Blogs."</p><button class="btn btn-primary">View My Favorite Blogs</button> <button type=button class="btn btn-info">View All Blogs</button><h3>Click on the Sort Icon to Order Blogs by a Specific Column</h3><p>Blogs can be ordered by title, MozRank, Page Authority, external links, and Twitter followers.</p><img src=assets/images/ed20cb3b.sort.png width=60><br><br><p>Top Programming Blogs is the capstone project of Charles Sipe for the Bloc Front-End Development Online Bootcamp. You can read more about his bootcamp experience at <a href="http://www.charlessipe.com/bloc-review/">http://www.charlessipe.com/bloc-review/</a>.</p><p>Please send feedback to Charles Sipe at csipe84(at)gmail.com.</p><footer class=footer><p>Angular Fullstack v2.0.13 | <a href=https://twitter.com/tyhenkel>@tyhenkel</a> | <a href="https://github.com/DaftMonk/generator-angular-fullstack/issues?state=open">Issues</a></p></footer></div></div></div>'),a.put("app/main/main.html",'<div ng-include="\'components/navbar/navbar.html\'"></div><div class="col-xs-12 top-section"><!--<a href="">Log In To Vote</a><br> \n    <a href="">Log Out</a> --><p>Hello {{ userName }}.</p><h1>Top Programming Blogs</h1><p>Top Programming Blogs ranks the top blogs in the programming field based on the votes by the community and website metrics.</p></div><div ng-init=randomImage() class="col-xs-12 table-container" style="background-image: url(\'{{currentImage}}\')"><table class="table table-bordered"><thead><tr><th>Number</th><th width=10%><span ng-click="sortBy = \'name\'" class="glyphicon glyphicon-sort-by-attributes-alt"></span> Blog Title</th><th><span ng-click="sortBy = \'-votes.length\'" class="glyphicon glyphicon-sort-by-attributes-alt"></span> Votes</th><th><span ng-click="sortBy = \'-mozrank\'" class="glyphicon glyphicon-sort-by-attributes-alt"></span> Moz Rank</th><th><span ng-click="sortBy = \'-pageauthority\'" class="glyphicon glyphicon-sort-by-attributes-alt"></span> Page Authority</th><th><span ng-click="sortBy = \'-linkingsites\'" class="glyphicon glyphicon-sort-by-attributes-alt"></span> External Links</th><th>Twitter Name</th><th><span ng-click="sortBy = \'-twitterFollowers\'" class="glyphicon glyphicon-sort-by-attributes-alt"></span> Followers</th><th>Lastest Article</th></tr></thead><tbody><tr ng-repeat="blog in blogs | orderBy: sortBy | filter:filters"><td>{{$index+1}}</td><td class=text-left><a href="{{ blog.mainUrl }}">{{ blog.name }}</a></td><td><span class="glyphicon glyphicon-thumbs-up" data-ng-click=addVote(blog)></span> {{ blog.votes.length }}</td><td ng-init=updateBlogScore($index)>{{ blog.mozrank | number:2 }}</td><td>{{ blog.pageauthority | number:2 }}</td><td ng-init=getMozData($index)>{{ blog.linkingsites | number }}</td><td><a href="{{ blog.twitterUrl }}">{{ blog.twitterName }}</a></td><td ng-init=getTwitterCount($index)>{{ blog.twitterFollowers | number }}</td><td class=text-left ng-init=showRss($index)><a href={{blog.rssUrl}} target=_blank>{{blog.rssTitle}}</a><!-- {{blog.rssFeed}} --></td><button ng-click="filters.votes = currentUid" type=button class="btn btn-primary">View My Favorite Blogs</button> <button ng-click="filters = undefined" type=button class="btn btn-info">View All Blogs</button></tr></tbody></table></div><div class=row><div class="col-lg-12 suggest-blog"><p><span class="glyphicon glyphicon-plus-sign"></span> Suggest a Blog</p><form><span>Title:</span> <input ng-model="newContent"><br><span>Blog URL:</span> <input ng-model="newMainUrl"><br><span>Twitter:</span> <input ng-model="newTwitter"><br><span>Twitter URL:</span> <input ng-model="newTwitUrl"><br><span>RSS Feed:</span> <input ng-model="newRss"><br><button class=add-blog type=submit data-ng-click=addBlog()>Add Blog</button></form><p>All fields must be filled for a new blog to be added.</p></div></div><!--\n    <p>Twitter username test:</p>\n    <div class="row" style="margin-top:5px;">\n      <div class="col-xs-12">\n        <input class="form-control" type="text" placeholder="Twitter User Name (e.g. BoyCook)" ng-model="userName">\n        <br>\n        <br>\n        <p class="text-center"><button class="btn btn-primary" ng-click="getUser(userName)">Get User</button></p>\n      </div>\n    </div>\n\n    <div class="row" ng-if="twitterErrors">\n        <div class="col-xs-12">\n          <div class="alert alert-danger">\n            {{twitterErrors}}\n          </div>\n        </div>\n    </div>\n\n    <div class="row" style="margin-top:50px;" ng-if="results">\n        <div class="col-xs-12">\n          <p class="text-center"><img ng-src="{{results.profile_image_url}}"></p>\n          <table class="table table-bordered">\n            <tr ng-repeat="(key, value) in results">\n              <td>\n                {{key}}\n              </td>\n              <td>\n                {{value}}\n              </td>\n            </tr>\n          </table>\n        </div>\n    </div>\n    --><!--\n    <ul>\n      <li ng-repeat="x in names">\n        {{ x.Name + \', \' + x.Country }}\n      </li>\n    </ul>\n    \n    <ul>\n      <li ng-repeat="followers in twitterFollowers">\n        {{ followers.followers_count }}\n      </li>\n    </ul>\n  \n    <ul>\n      <li ng-repeat="racers in racerNames">\n        {{ racers.Driver.givenName }}\n      </li>\n    </ul>\n    --><!--\n    <ul>\n      <li ng-repeat="data in siteData">\n        {{ data.uu }} \n        {{ data.umrp }}\n        {{ data.upa }}\n      </li>\n      <li>MozData goes here</li>\n      \n      {{mozData}}\n    </ul>\n\n    <p>URL: {{mozData.uu }} </p>\n    <p>MozRank: {{ mozData.umrp }} </p> \n    <p>External Links: {{ mozData.ueid }} </p>\n    <p>Page Authority: {{ mozData.upa}}</p>\n    --><div ng-repeat="rss in myRss"><h5><a href={{rss.link}}>{{rss.title}}</a></h5><p class=text-left>{{rss.contentSnippet}}</p><div class="line line-lg b-b b-light"></div><div class=text-muted><i class="fa fa-clock-o text-muted"></i> <span class=small>{{rss.publishedDate}}</span></div></div><!--\n<header class="hero-unit" id="banner">\n  <div class="container">\n    <h1>\'Allo, Charles</h1>\n    <p class="lead">Kick-start your next web app with Angular Fullstack</p>\n    <img src="assets/images/d535427a.yeoman.png" alt="I\'m Yeoman">\n  </div>\n</header>\n\n<div class="container">\n  <div class="row">\n    <div class="col-lg-12">\n      <h1 class="page-header">Features:</h1>\n      <ul class="nav nav-tabs nav-stacked col-md-4 col-lg-4 col-sm-6" ng-repeat="thing in awesomeThings">\n        <li><a href="#" tooltip="{{thing.info}}">{{thing.name}}</a></li>\n      </ul>\n    </div>\n  </div>\n</div>\n\n--><footer class=footer><!-- <div class="container"> \n   \n    <div ng-repeat="feed in feeds">\n	<h2><a href="{{feed.link}}" target="_blank">{{feed.title}}</a></h2>\n	<p><span ng-repeat="item in feed.entries">\n		<a href="{{item.link}}" target="_blank">{{item.title}}</a> (<span>{{item.publishedDate | date:\'d-MM-yyyy HH:mm\'}}</span>)<br />\n	</span></p>\n</div>\n   --><!--\n    <div ng-repeat="feed in feeds" > \n    <h5><a href="{{feed.link}}">{{feed.title}}</a></h5>\n <p class="text-left">{{feed.contentSnippet}}</p>\n <div class="line line-lg b-b b-light"></div>\n <div class="text-muted">\n  <i class="fa fa-clock-o text-muted"></i>\n  <span class="small">{{feed.publishedDate}}</span>\n      </div>\n    </div>\n    --><p>Angular Fullstack v2.0.13 | <a href=https://twitter.com/tyhenkel>@tyhenkel</a> | <a href="https://github.com/DaftMonk/generator-angular-fullstack/issues?state=open">Issues</a></p></footer>'),a.put("components/modal/modal.html",'<div class=modal-header><button ng-if=modal.dismissable type=button ng-click=$dismiss() class=close>&times;</button><h4 ng-if=modal.title ng-bind=modal.title class=modal-title></h4></div><div class=modal-body><p ng-if=modal.text ng-bind=modal.text></p><div ng-if=modal.html ng-bind-html=modal.html></div></div><div class=modal-footer><button ng-repeat="button in modal.buttons" ng-class=button.classes ng-click=button.click($event) ng-bind=button.text class=btn></button></div>'),a.put("components/navbar/navbar.html",'<div class="navbar navbar-inverse navbar-static-top" ng-controller=NavbarCtrl><div class=container><div class=navbar-header><button class=navbar-toggle type=button ng-click="isCollapsed = !isCollapsed"><span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span></button> <a href="/" class=navbar-brand><span class="glyphicon glyphicon-circle-arrow-up"></span> Top Programming Blogs</a></div><div collapse=isCollapsed class="navbar-collapse collapse" id=navbar-main><ul class="nav navbar-nav"><li ng-repeat="item in menu" ng-class="{active: isActive(item.link)}"><a ng-href={{item.link}}>{{item.title}}</a></li><li><a ui-sref=instructions>Instructions</a></li><li><a ui-sref=about>About</a></li></ul></div></div></div>')}]);